# Supervisord configuration for DripEmails cron.py
# This configuration replicates the cron jobs:
# - SPF check: Daily at 2 AM
# - Scheduled emails: Every 5 minutes
#
# Based on cron jobs:
# 0 2 * * * cd /home/dripemails/web && /home/dripemails/dripemails/bin/python3 cron.py check_spf --settings=dripemails.live --all-users >> /var/log/dripemails.log 2>&1
# */5 * * * * cd /home/dripemails/web && /home/dripemails/dripemails/bin/python3 cron.py send_scheduled_emails --settings=dripemails.live >> /var/log/dripemails.log 2>&1

[program:dripemails-cron]
# Use the wrapper script that handles both SPF checks and scheduled emails
command=/home/dripemails/web/cron.sh
directory=/home/dripemails/web
user=dripemails
autostart=true
autorestart=true
startsecs=10
startretries=3
redirect_stderr=true
stdout_logfile=/var/log/dripemails.log
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=10
stderr_logfile=/var/log/dripemails-error.log
stderr_logfile_maxbytes=50MB
stderr_logfile_backups=10
environment=DJANGO_SETTINGS_MODULE="dripemails.live",PYTHONPATH="/home/dripemails/web"
stopsignal=TERM
stopwaitsecs=10
killasgroup=true
priority=1000
